---
layout: post
title:  "策略产品课 - 豆瓣推荐模块调研分析方法论（week2）"
date:   2018-05-10 20:50:00 +0800
tags: Learning
category: Work
---

~ 本周作业是分析豆瓣「喜欢这本书的人也喜欢」模块的调研分析。本文的前半部分是问题和论文思路，后半部分是自己的作业。 这次的作业有点难度，看起来好像很简单，但是实际写「需求理想态」、「调研目标」和「抽样维度」的时候。还是遇到蛮多困惑的。


## Q：不知道如何定义理想态、以及调研目标、还有如何计算相关评估指标

- （1）从用户行为角度来说，如何衡量用户对推荐的「喜欢」程度？
    - 是以点击率作为理想态指标？
    - 还是以点击后的「收藏」或「想读」的行为作为衡量指标？

- （2）从书籍的属性角度来说，如何衡量书籍标签的相关度？用户喜欢度与书籍属性之间的关系？
    - 被推荐书籍与当前搜索书籍的所有标签的计算相关度作为衡量指标？那么如果收录的标签有遗漏怎么办？

- （3）衡量指标的方式有准确率和召回率两种
    - 准确率等于`用户点击的被推荐书籍的数量 / 已推荐的书籍总数量`，或 `用户点击书籍后再继续点击了'收藏'或'想读'的数量/推荐的书籍总数量`
    - 那么召回率如何计算呢？`用户点击的被推荐书籍的数量 / 所有应该被推荐的书籍（喜欢这本书的用户也同样喜欢的其他的书籍）`，如何制定分母的从所有书籍中筛选出来的规则？如：是「运营」相关所有书、还是和互联网相关所有书？
    - 覆盖率和召回率 是一个东西吗？我的理解：覆盖率 = `已推荐的书籍总数量/所有应该被推荐的书籍（喜欢这本书的用户也同样喜欢的其他的书籍）`

......带着这些疑惑，翻看了几遍视频，后来决定放弃写作业之前，突然想到了刚买的《内容算法》，找到了一点思路。然后找了下论文，先不管怎么实现吧，反正能继续写作业就OK了。。

## 没法下手，直接查了资料

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-062413.jpg)
> 

在《内容算法》的「推荐算法：物以类聚，人以群分」里提到：

> **基于内容属性**推荐的**好处**在于，只依赖物品本身的特征而不依赖用户的行为，让新的物品、冷僻的物品都能得到展示的机会。其**存在的问题在**于，推荐质量的优劣完全依赖于特征构建的完备性，但特征构建本身是一项系统的工程，存在一定成本。
> 
> **如果标签词粒度不够细，不能够全面**描述书的内容（比如每本书的标签词只有三个），就很难计算出置信的相似度，达不到足够好的推荐效果。
> 
> ---
> 
> 为了在推荐中更好地引入受众反馈因素，提出了基于用户行为的**“协同过滤”**概念。
> 
> 把用户的**消费行为作为特征**，以此进行**用户相似性**或**物品相似性**的计算，进行信息匹配，是协同过滤（Collaborative Filtering）的基础。
> 
> 协同推荐可以分为三个子类：基于物品（Item-based）的协同、基于用户（User-based）的协同和基于模型（Model-based）的协同。
> 
> 1. **基于用户的协同**就契合了上面的例子，其基础思路分为两步：第一步，找到那些与你在某一方面口味相似的人群；第二步，将这一人群喜欢的新东西推荐给你。![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-Snip20180510_112.png)
> 2. **基于物品的协同**，其推荐的基础思路是：先确定你喜欢什么物品，再找到与之相似的物品推荐给你。只是**物品与物品间的相似度不是从内容属性的角度衡量的，而是从用户反馈的角度衡量的**。![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-063513.jpg)
> 3. **基于模型的协同**，是用用户的喜好信息来训练算法模型，实时预测用户可能的点击率。
> 
> ---
> 
> 协同推荐是目前应用最为广泛的推荐机制，其基于用户行为的特点使我们不需要对物品或信息进行完整的标签化分析和建模，从而实现了领域无关，可以很好地发现用户的潜在兴趣偏好。
> 
> 但考虑到**协同过滤的方式依赖历史数据，新的用户和新的物品会存在冷启动的问题**。

然后查了相关论文：
 
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-055019.jpg)
> 

没来得及看，只看了基于模型的协同：参考：基于深度学习的协同过滤模型研究_余冲.caj

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-Snip20180510_115.png)
> 
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-070019.jpg)
> 
> ---
> 
> **评价指标：**
> 
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-Snip20180510_117.png)
> 
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-Snip20180510_118.png)
> 
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-071240.jpg)


## 有点头绪了，继续做作业：

### 作业题目：

![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-Snip20180510_125.png)

![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-Snip20180510_124.png)


### 工作目标：

对「豆瓣-喜欢这本书的人也喜欢」模块的推荐策略做「问题优化」的调研分析


### 用户需求分析

以《运营之光》为作业案例，用户搜这本书，行为背后的动机可能是：

1. 需要解决问题：如工作需要，是一个互联网 + 运营经理或产品经理，需要该书指导工作方法论
2. 不需要解决问题：如个人在这个领域的兴趣、或朋友推荐等；

满足上述需求，需要以下信息对推荐策略进行输入->计算->输出：

1. 用户的基本特征：
    - 基本信息标签：性别、生日、定位地点等（在统计数据下预测）
    - 用户行为标签：根据用户所关注的话题、其他用户、豆列等；以及对书籍的收藏、读过、喜欢等行为，计算出来的标签
2. 书籍的基本特征：
    - 基本信息标签：书名、作者、副标题、出版社、简介等
    - 其他用户对该书产生的行为标签：评分、评价、笔记、被收藏的分类、被豆瓣成员标记的常用标签等

计算方式：

1. 根据用户、书籍的基本特征，根据推荐算法对输入特征的关系进行计算（如协同推荐算法）
2. 计算推荐关系后，根据「喜欢」程度进行排序并显示给用户...

### 定义需求理想态：

用户对「喜欢这本书的人也喜欢...」模块下推荐的书籍进行点击，产生「喜欢」行为操作，包括：

![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-071826.jpg)

（1）加入购书单/收藏夹/想读/豆列等**显式反馈**，计算喜欢程度阈值；

（2）对该推荐书籍的评分/写笔记/写评价，根据笔记和评价的好坏、评分的分值计算用户对于该书的喜欢程度阈值；并计算在该推荐书籍的页面的停留时长、是否继续产生其他行为操作，如查看别人评论、分享等**隐式反馈**，计算用户对该书的喜欢程度阈值。


### 抽样的分析维度：

> 确定调研目标→确定抽样对象→选择抽样方法→确定抽样数量→样本分析标注→整理汇总问题

#### （1）调研目标：


**要考虑覆盖率情况**，所以不能只调研`系统给用户推荐的所有书籍`，还有哪些是用户可能喜欢的书籍但是没有被推荐？根据什么标准来衡量用户推荐的成功率？--> 被当前用户点击后操作且「喜欢」？

~ 这里有一个大大的问号！如何找出「用户喜欢的所有书籍」作为推荐书籍的覆盖率的除数？还是说可以直接除以所有书籍数量？感觉数学不好，脑子想不动了。还是假设了两种可能性：

- a：「搜索」过同一本书的所有用户，取他们喜欢的所有书籍的交集。
- b：「喜欢」过同一本书的 -- 所有用户的 -- 所有喜欢的书籍
- c：和「搜索」过同一本书的所有基本信息相近的用户群体，所有他们喜欢的书籍

后来想了想，搜索该本书的用户所喜欢的书籍中，有可能包含了我喜欢的书籍。但是「喜欢」该本书的用户也能包含我喜欢的书籍嘛，感觉「搜索」大于「喜欢」，还是选方案a。但是方案c呢，如何计算和我基本信息特征相符合的人，他所喜欢的书籍和我喜欢的书籍的关系？c 就彻底想不动了。


OK，根据方案 a 的用户行为片段，分析具体问题。

**调研目标**：抽取所有**共同搜索过**某本书籍的所有用户的行为数据（session）。

- **子目标2**：抽取「共同搜索过」该本书籍的全部用户的所有「喜欢」的书籍数据，-->分析当前书籍与被推荐书籍的标签相关度、多样性等；（统计推荐书籍在全书籍中的覆盖率）


#### （2）确定抽样对象

筛选规则：

> **核心指标未达到理想态**、可以**代表全体用户的行为**的**最小时间窗口**内的**全量数据**。

核心指标：（这个指标怎么计算呢？）

> 1. 指标1：预测准确度
> 2. 指标2：分类准确度：准确率、召回率
> 3. 指标3：覆盖率
> 4. 指标4：丰富度/多样性
> 5. 指标5：新鲜度/时效性

未达到理想态的不同情况

1. **复杂情况**：根据用户与该推荐书籍的关系，来计算上述各指标的得分，加权得出用户对被推荐书籍的「喜欢」程度值。如：
    - 基于基本特征的-用户关系：两个用户的基本特征的重合，则根据特征数量和类别，对用户群体进行聚类或计算相关性；
    - 基于喜欢相同书籍的-用户关系：同时喜欢了相同书籍的多个用户，根据喜欢书籍的重合数量，对进行聚类或计算相关性；
    - 基于被同一用户喜欢的-书籍关系：同一用户喜欢了该书籍以外的其他书籍，根据书籍标签计算？
    - 基于基本特征的-书籍关系：两本书籍的基本特征的重合，则根据特征数量和类别，对书籍进行聚类或计算相关性；
2. **简单情况**：根据用户对该推荐书籍的后续点击行为，计算用户的「喜欢」程度。

样本类型：（分析维度）

在该全量数据的某时间戳下，筛选用户的行为片段：

1. **未点击**任何「也喜欢」模块的推荐书籍的行为数据
2. 点击了「也喜欢」模块的推荐书籍，但是**未产生**后续「喜欢」行为的数据




#### （3）选择抽样方法

简单随机抽样

#### （4）确定抽样数量

> 策略相对程度已经没有影响面>5%的显著问题，接下来要看影响面1~5%量级的问题： 
> 
> 为了使1%问题的case数量至少达到5，那抽样数量最少要500。或者在1k的量级、即代表单个问题的case在至少为10个左右，此时得到的问题影响面数据才有较高的置信度。

#### （5）样本分析标注

1. 书籍属性标签的相似性：被推荐书籍属性与当前书籍属性的相关度
2. 用户属性

标注方式：

对书籍的豆瓣标签、豆列、作者、做出标记，计算书籍的相关程度。以及搜索用户的个性匹配相关程度。

因为时间很赶，就略了。


#### （6）整理汇总问题

选择的分析框架是用户行为片段分析。

![](http://ojcp18ifz.bkt.clouddn.com/2018-05-10-%E3%80%8C%E5%96%9C%E6%AC%A2%E3%80%8D%E6%A8%A1%E5%9D%97%E6%8E%A8%E8%8D%90%E7%AD%96%E7%95%A5%E9%97%AE%E9%A2%98%EF%BC%9A%20%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E7%89%87%E6%AE%B5%E5%88%86%E6%9E%90.png)


---

### 总结

作业写得不咋地，...只能看看大家的作业，向大家学习啦~

- created，180510

