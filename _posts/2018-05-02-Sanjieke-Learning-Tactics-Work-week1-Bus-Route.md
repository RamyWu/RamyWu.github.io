---
layout: post
title:  "策略产品课 - 公交路线策略分析（week1）"
date:   2018-05-02 02:02:00 +0800
tags: Learning
category: Work
---

~ 参加了三节课的[策略产品经理的实战修炼](https://class.sanjieke.cn/course/3610846.html)，感觉还不错。

我对策略产品课程的理解是，策略产品课的目的就是对需求进一步精细化分析，拆解背后的逻辑；而常规的产品课程更多的是对需求分析的理解、功能设计、交互设计等学习或练习。所以，在策略产品课我将更专注在计算规则的逻辑分析和设计上，不会做过多的需求分析了。

week1的作业有两个：（1）公交路线推荐策略（2）视频结束后的其他视频推荐策略

本文的前半部分是作业-「公交路线推荐策略」的作业内容和笔记，先刷完课程视频，根据策略产品的分析四要素，对公交路线功能背后的产品逻辑进行拆解，先完成第一版作业提交。完成作业以后，查询相关论文，并摘出关键信息，进一步将计算规则细分下去（虽然看我论文发现自己依然拆分逻辑这部分不够详细，但是也发现了自己拆分过程中十分的粗陋）。

## 作业题目：

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-Snip20180503_31-1.png)
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-Snip20180503_32.png)

## 分析不同用户在同一场景下的目标或需求

用户搜索地铁路线的目标是为了从出发地点到达目的地点。但是，在不同的时间、地点，以及背后的原因，用户所需要的路线会有所不同。如果只给出一种普适的路线，在不同需求下的用户可能会觉得不适合而放弃根据地图所推荐的路线而出行。


### 常见的场景：


1. 早上7-8点上班，从家里出发去公司（一般刚在新公司上班才会需要地图，熟悉路线后不需要地图导航）；
2. 晚上10点加班后回家，查看还有什么地铁和公交可以更快地回家；
3. 女生周末穿得美美的去购物、约好地点见闺蜜好友；
4. 周末还需要参加一个公开活动或会议，在规定时间之前要到达现场；
5. 从外地来旅游的游客，携带行李，从机场或火车站出来查地图去酒店；
6. 从外地来旅游的游客，不熟悉路线，出发去景点；



### 根据上述需求，不同的用户需要的路线有所差异：



1. 上班路线：如果担心迟到的用户，就需要最快的路线（包括需要考虑到换乘带来的排队时间）；如果是不担心迟到想在路上看手机刷新闻的用户，可能需要换乘少、步行少的路线；
2. 下班路线：如果是正常高峰期下班，可能不需要导航，直接根据上班相反的路线回家；如果是加班到深夜下班，查询最近一趟的公交或地铁是否关闭，加上工作这么晚很累了，可能需要换乘少的路线；
3. 周末女生逛街，可能穿高跟鞋，不希望拥挤的人群影响出行的心情，对时间不那么高的要求，可能需要换乘少、不拥堵的路线；
4. 周末还要参加会议，不能迟到，对时间的要求比较高，可能需要时间少的路线；

### 需要考虑的影响因素：


- 时间（上下班高峰期、拥堵情况，预估的路线时间需要根据实际情况而延长）
- 路况（上下班高峰期，选择公交车可能会堵车在路上导致时间延长）
- 天气（雾霾、下雨，在户外的公交站等车会令人不适，选择地铁更合适）
- 维修（如果途经的地铁维修，需要在推荐路线中注明或删除该条路线的推荐显示）
- 周末（根据用户输入的地点是购物商圈、景点还是公司活动地点，来推荐更合适的方案，如购物商圈推荐步行少和换乘少的方案）
- 外地游客（根据用户历史行为和地理位置（如广东人来到北京，刚到北京的定位），来推荐更简便的路线--如换乘少更合适，减小在陌生环境中复杂路线的换乘给游客带来的心理压力）
- ...

---


## 推荐路线策略的四要素

需要结合用户当前实际场景，分析不同的用户需要什么样的路线。


### 要素1：待解决问题

从不同的路线组合中，选出最合适用户出行的路线

### 要素2：输入

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-WechatIMG734.jpeg)

（1）用户基础信息特征

- 所有用户的位置；
- 注册用户的性别、年龄，推测该用户属于上班族还是学生；
- 历史行为（如历史选择推荐方式，预测用户喜好）


（2）用户输入信息特征：

- 出发地点（默认是当前手机定位）
- 到达地点（用户键盘输入地点，并根据首字推荐相关地点，如输入「西」显示「西单」「西直门」「西二旗」...）
- 路线方式：叫车、驾车、公交、骑行、步行、火车、客车等；
- 选择路线方式：推荐、步行少、换乘少、时间短、地铁优先、不坐地铁、骑行优先、不含骑行；

（3）候选路线信息特征：

- 所有交通工具名称和路线号（如地铁-13号线、公交车-332路）；
- 所有线路的地铁进站口或公交上车地点；
- 所有线路的站台数量、各个站台名字；站与站之间的时长；
- 各站路线的价格；
- 路线换乘：不同路线的换乘站之间的步行距离、步行所需时长；

### 要素3：计算方式

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-WechatIMG735.jpeg)

根据输入的各项信息特征，进行组合与计算：

- 出发地点（默认定位距离）到达附近公交站台或地铁进站口的距离、和所需步行/骑行时长；
- 在所有候选路线中，取出附近能够到达目的地附近的站台的起始站，计算路线、时长、价格；
- 得出多条不同的路线（如地铁出发 - 中途换乘 - 目的站台；公交出发 - 中途换乘 - 目的站台）；
- 计算步骤3得出的每条路线所需的总时长、步行总距离、价格、换乘数量，根据不同方案（如步行少、换乘少、时间短、地铁优先、不坐地铁、骑行优先、不含骑行）下的规则与计算公式，得出各个方案排名靠前的路线，供用户选择；
- 系统推荐方案：计算同时满足多条方案的最佳路线，供用户选择；

### 要素4：输出

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-WechatIMG736.jpeg)
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-WechatIMG737.jpeg)

计算完成后的路线，并根据推荐方式进行排序（如：时间短 - 将总时长最短的路线排首行，依次往后）

- 推荐最佳的路线（同时满足多个条件，如换乘少+总时长少）
- 不同方案的路线（仅满足一个条件，如换乘少）

页面展示数据：包括：

- 当前定位到达地铁进站口/公交上车地点前：步行距离+步行所需时长；或选择骑行+骑行所需时长；
- 起始路线：地铁进站口/公交上车地点；路线方向；下一个站台名称；该路线的过站数量、时长；
- 换乘路线：地铁站台/公交上车地点；路线方向；下一个站台名称；该路线的过站数量、时长；
- 换乘中途：两个站台之间的步行距离、步行所需时长；
- 出地铁站/下公交车后：步行距离+步行所需时长；或选择骑行+骑行所需时长；

---

## 思考&查找相关论文资料

根据参考资料中的论文，对比改进我的策略计算方式

### 补充-影响因素：

#### 轨道客流分布特征

> 1. 客流特征：空间分布：
    - 均等型分布：车站的上下客流和换乘客流较为均衡，全时段客流变化幅度基本一致；
    - 两端萎缩型分布：当轨道交通路线里程过长，路线穿越城市主城区且两端伸入城市边缘地区或郊区时，末端的轨道交通出行需求有限，路线两端的客流逐渐减小；
    - 中间突增型分布：与换乘量大的轨道路线换乘时，位于该区间车站站点的上下车客流量显著增大；
    - 逐渐缩小型分布：随着路线向城市郊区的逐渐延伸，客流也随着逐渐缩小
2. 客流特征：时间分布：
    - 单向峰型：轨道交通路线所处的交通走廊具有显著的潮汐交通特性、车站所处
地区用地性质较为单一且客流出行量较大时，有早晚一个上车高峰和一个下车高峰；
    - 双向峰型：当轨道车站处于综合功能用地区位，周边土地开发性质同时囊括居
住用地和商业办公用地时，有两个配对的早晚上车/下车高峰；
    - 全峰型：当轨道交通路线通过城市开发成熟的交通走廊、车站处于公用设施高度集中的 CBD 地区、衔接大型的公共设施，如博物馆时，客流出行高峰与低谷差异较小，全天上车/下车客流都很大；
    - 凸峰型：当轨道车站毗邻影剧院、体育场馆等大型社会公共设施时，在演出节目或体育比赛之后一段时间内，将出现一个持续时间较短的突变的上车高峰；
    - 无峰型：路线经过的地区周边尚未完全开发时，车站客流无显著的上下车高峰，双向的上车/下车客流全天都较小；

#### 用户出行选择影响因素：

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-165121.jpg)

#### GPS轨迹数据偏差

> 通过 GPS 定位系统获得的轨迹数据与实际道路之间存在偏差，造成了轨迹匹配的不确定性。


### 改进计算方案：

计算规则内部拆分功能模块：

> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-174207.jpg)
> 
> 参考：最优公交路线查询系统设计_肖文翀

算法设计思路：

> 1. 首先创建数据库，收集车次表、站点表 ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-171646.jpg)
> 2. 出行路线类别分析：![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-171849.jpg)
> 3. 步骤分析：![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-Snip20180503_26.png)![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-Snip20180503_27.png)![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-172730.jpg)
> 
> 参考：公交出行最优路线查询系统设计-刘健

出行路线组合方式：


> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-Snip20180503_21.png)
> ![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-Snip20180503_22.png)
> 
> 参考：城市轨道交通的接运公交路线与运行时刻表优化研究_黄子富
 

### 增加-评价指标：

Q：这里不太清楚如何评价算法计算结果，有哪些指标？

---

## 参考资料 & 论文：

![](http://ojcp18ifz.bkt.clouddn.com/2018-05-02-155021.jpg)

- 绿色标记-直接相关
- 黄色标记-部分相关
- 灰色标记-无相关

---

- created，180502


